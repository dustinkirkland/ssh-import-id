# flake8: noqa
import pytest
import ssh_import_id


@pytest.mark.parametrize("keyline, expected", [
    ('ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMkGoTfVoNpsJrNxzq9WpRhlCp0qsPwsOHopWxNbIM8Z smoser@frink',
     '256 SHA256:XCEFfvF2V6u0ESVb/GLp/HAHVCZMoi36uskzHxTBUk0 smoser@frink (ED25519)'),
    ('ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDg6lO2L8jcnFlpASMsAD7nc3B7QO/c4IzJBOzaEh1GU0+50hT+tdk0+bdCTWxZteycs6rojJtizjhiHOluvKoSTg9ld9fFVSaJ76zyEHj9yBA0UgiDJqgeUadEguv8L7HpjKD6wabFbo5rx65a0wotXpyNv/YzmhthiSrhqOYUwTJ0lNZt3wYJxsx4GQ+8eGymXYsSBNWhAfeQT1AN/gnVza6oP3QEjyM8q1xTCl9WgKXnkz1N+TxTxvPlt0f7y1YAUg02sIL9AAtyPhY/tVEJfZFGuH7obcDJwpwTsGC341+X5q7YD9EJx9x9V5WjIKiWj40xTLQGH4pc2a6liXn4sT4V7pqKAH7cxGnASk7ZzhGP3B+g2GAMtQC0WfrDeJNUryhG3g6x41nyqtUsZeDUvRS7rGryTUNNvUScI3zhV36YC9OvS+h/EcQ4vLyanTcNSi1uvfiOa7A69Qyd76rh584k9xdf0YfV+6mswKPrTery5TSkcaw8BsN4BqeTiM2wpgAmK+OmgdFZ7xiQmJXLfCFND8ApW+WTWU5FOZpeFFTIWp9hBnJLA8U9bBoV+krRmZj7QlZetFP78C9E8ywgoDRpjORR39jt9vRXhHpWPk5Ox5/UNGsN9Bx8oEZz9kqfrc2Ja8nqp5bB+9LiBqn3+AIQK7qp/1hjnOS+/syIOQ== coredev@1234',
     '4096 SHA256:Zopg0vu2nLCbM4cPb20OeI2VcSC3lc0ddLIILb5UFsg coredev@1234 (RSA)'),
    ('ssh-dss AAAAB3NzaC1kc3MAAAEBAJL94TuurlB6dgU3rbWIcjvVldjfhOAu+tszkoGMeISxY7AFQcBbWM6iB0qHRIu622lR05LB/0tMS3i2VPw8DmhNYr68CbvcvNXVoHyam6JtwIDbTltMpv2L/oyQUdezZXM9XafK1+8JeRoNUYZgEr5KBTem7i8vqXtb77u54n3jkQJhi+TlI8ryMUB5dwUagPUlZ8fxZ3R6U2mZlBSbdVEF3AqZK1YfNXYUBR8OJCX4Fn9dCzMtNzjeexFvsMev15qRmZON/V/7nOfcOQqx/mPV4KPO1SQG4PgC1gPdrZm4054cxu+niB+jPRThyZd6Zg89yLitlFIwqPjImIongpUAAAAVANWt851JbYdUDSrCPVxN5HMtqYO5AAABAQCOcawGLkeKwrcWQuTxwfiTMGd+j/KfjopD4xqQf4m8Gu8bAffRkNnYB4UB52Lt9qFrxOngJp88E8syMWf7HCvYsoyRJHiRopv+tgN67ZHB7i/v6pzT9cBOfTfwou7BhNR/crEFxv7fTjxkx1l2KuQcUpaNPl5KqTEIqjjHUneLCmuKKCzvUmHdQTMFPsnib7k4MKr8lOJh2qrmWshfG6NSyX54vlCmM2IdriPlh3A1kBHOf+7JuemhlbToLWWcT5lNONLTuP7YRuIjNnnkLNwDiRNLCHGsj93ecQcidWDqA9pNd6W45Jd1onRtyDh/r1FnEJrNxbkNP2AcEUEe5SzZAAABACRWszpm1qqO7zMO8O+lrdfBRhQwNBUvtL3kWgWUJrJ6A4k08bne+6KqINw08jdPKETm+WbJc96s13D4XdvCZBzW5+n8FYO0rkcYyR2fh+GXvskptwWjl8nCSZ28H48gqDupr50wXbm7OjIQ1W2aMlYtp66/1CzZXByWex2Q7JlOYd41dBWqkRxvnM7h9w97PygkbRz0bxQit2hFLTYS1VXAf0xkA8NJ5AWvDk0dWOSxsNFnC0NM7K2nE+FRDKitmqydrSpxakgN95mx2a+mWBdJCLXLAK6ujQusdJKh8GkzyRuWQ/nq0ccysrUxjFFUt7o/EngXsIqhEOupDUskdsQ= coredev@hostname',
     '2048 SHA256:Z9rHxUuI39Ze/C9iZ1ODdNr+lSIjgrdhssYN3YzirYk coredev@hostname (DSA)'),
    ('sk-ecdsa-sha2-nistp256@openssh.com AAAAInNrLWVjZHNhLXNoYTItbmlzdHAyNTZAb3BlbnNzaC5jb20AAAAIbmlzdHAyNTYAAABBBNub7yaBe9xSCCAtYG0N1VXtKnYCRCkpFUlCldjLIyYv1Xz0oJQBIJHO/HLJ2H/ZlP/ObKplN+l0mHnW9ACxlOMAAAAEc3NoOg==',
     '256 SHA256:FAD8F89UgyBHO7araYQSCe5QtLthlx6fTO7DBktf0E8 no comment (ECDSA-SK)'),
    ('sk-ssh-ed25519@openssh.com AAAAGnNrLXNzaC1lZDI1NTE5QG9wZW5zc2guY29tAAAAIDUoNG0ZFnEUpkmTfkUOrXqidO1bi6PJAmHw9qnul9NuAAAABHNzaDo=',
     '256 SHA256:ODe/XhzkNdD94qkx0Dvjv4BGwQ066GU9o6Qs8olG7Tw no comment (ED25519-SK)'),
    ('ecdsa-sha2-nistp521 AAAAE2VjZHNhLXNoYTItbmlzdHA1MjEAAAAIbmlzdHA1MjEAAACFBACID0zdlqmLKz+mHp+8g9mfz10krSfYpo5+km0F4Gzj9zhTvCcTGoWFC6lpNr9byd7YRvB8HBvvoXfG6TmV61wVYgHw8cv2BBISqj09wRn4NNNF3+CITgzlBOgBbEeEweYC08OU+Gjs1Gahb2FR7INc1wDlHKvn/JkKHxM5IvRikeoIeA== coredev@ubuntu',
     '521 SHA256:eyOvhtnzTxYEWSP+9Lb2Yon4MqZ5EXFSnLBVS2Qok4M coredev@ubuntu (ECDSA)'),
    ('ssh-dss AAAAB3NzaC1kc3MAAACBAJ5uAFY6oaHLjlcuo5yf1x9gN5mcuDu5v7JmZKyvtPMJg/R5jljit5S3EGaFBNZ9DxcMf7yWsYmcRJxLZvYmCiSNIybJzBebAjeFjQr84XkC4X2XmTwLY7jkfu4hLh8zX5eUlsb2hmpZP9vN88rlU8KztQOyO3IuZ19rK0dhEbkxAAAAFQCVHwkTihnzBk9uwa4OvVjqgNax3QAAAIBWon7jwX+N4BN/jOTeZdJ3TM/uY4ZrUZHiPzBxqRVLkUerDgSZcjOHe7Lb7fEB6mAJdspjDjbnaSzgQEAFb//c05nIeq41g5MmPnxmvydBcfAACknQKpm52TwDMU2AC5q5Qx7ITGIsmQYFxpLfEixg20QIJQcqB+X6yg86zA74QwAAAIEAjtyS8EzSIhSLcRsjxb1wYoA03B+fWOkYFZxi1F4QQKf8UnDPUuXGye8cQKpuQikCcy1guYAdpM/wWgZZkdihPbDNeXzl03ReRXXNjhHl+46HF4kmXGwoTHH6HsOPkt77EaEiCep3Z1mcuAcZDBONsNcyM7ccTd1A6yYtsZ3kBvw= user@localhost',
     '1024 SHA256:RPKJJLRrJwL+QYMb8mIQOYV70k66ra1tBa7DrES2Vhc user@localhost (DSA)'),
    ('ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBIuWFtqIoZ7OzXwFcNS3ARY8qlE+QCC37MuzWLn7S7QNCsjeSFQj0fGtnfwwHXc+jOEzNPu49HCWZZ8XWUMrXGY= user@localhost',
     '256 SHA256:dPhT6je9SI3Ix6ouENaT5KC65AR7JrayViEz4sKqE1Q user@localhost (ECDSA)'),
    ('ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIBZD0BJ4cbO7gdR0ncScv++/uuVhNyVZIchrfaM4qcVs user@localhost',
     '256 SHA256:KNENJxaBWf6prhHPSPcMharb4yJpo2MDW6zqiOt9xW4 user@localhost (ED25519)'),
    ('ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDvFnRBKVATKQwUNjiLAXfl7Gl0gmB/PCgIIoaBZOKnK9ZciwYuYGD0Zs0lTs7AvmRQRZXQdwVNq1gdogQU9ZOYmKYYMxjbpLSNQzgM0CtUgKskKvt5d+7sz6iUDhGDVRKFKRdrQSPHTFJQMJYsC4t6gsdxtREd2yk9T6oPpYs+QgWl2Diyxgs3XLOcpeW3CkhzQ9z/OOeKGsOF1XOcz+CQHSLbcQcDbSRSxRG1qinIFgDc1V0tQoclW6R9JSH9He71+cqQxjlPR8djXGhPpFq/46wMqwcjr7A3x3syGhRHKKexEMzwyDrurcjozwvqdqN7FVDboskGgB2e+8SePU2V3FW2dfyZlRdZAyr+QSFqZAiWIOCInQi+IApZfYlMh9tnSitITtZWATgqDRPS/EUocO3Qk3047CMYbbfCCqOCxkboSwNG2AUh/z2UkeBQZXzm6cpguDiEwi8NSM0RebBcIfyGWZ4pC7AF7K/AkzK6wqjnyup84lYf3/0N/lSeLuc= user@localhost',
     '3072 SHA256:hC+atMjUVo0u0hhK5BHuoLPDA9+6diUy1wUL9/iq72U user@localhost (RSA)'),
])
def test_key_fingerprint(keyline, expected):
    assert ' '.join(ssh_import_id.key_fingerprint(keyline.split())) == expected
